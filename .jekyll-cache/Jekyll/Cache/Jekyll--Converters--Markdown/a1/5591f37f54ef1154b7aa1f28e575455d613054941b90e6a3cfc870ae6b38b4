I"Ü5<p>This is a post introducing the new Features of Java8.</p>

<h2 id="why-we-need-jdk">Why we need JDK?</h2>

<p>Why do we need JDK when we are already using Android SDK? After all, we are not developing for JVM.
The Android build process depends on a number of tools from the JDK. Check outÂ the build system overview documentation.</p>

<ul>
  <li>The first big piece we need from JDK isÂ javac- all your source code written in Java needs to be compiled before it can be converted to the DEX foramt.</li>
  <li>Once your code has been compiled, dexed, and packaged into an APK, we needÂ jarsignerÂ to sign the APK.</li>
  <li>Is there any difference between using JDK 1.6, 1.7 and 1.8? That depends on what features you are using from each. Older projects that donâ€™t use Java 7 features can use Java 6 without issue.</li>
</ul>

<p>There are some efforts out there to bring Java 8 features to Android, most notablyÂ gradle-retrolambda. Some of these require JDK 8 to compile properly.</p>

<h2 id="androidé…ç½®">Androidé…ç½®</h2>

<p>enable Java8</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>android {
  ...
  defaultConfig {
    ...
    jackOptions {
      enabled true
    }
  }
  compileOptions {
    sourceCompatibility JavaVersion.VERSION_1_8
    targetCompatibility JavaVersion.VERSION_1_8
  }
}
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="android-supported-java-8-language-features-and-apis">Android supported Java 8 Language Features and APIs</h2>

<ul>
  <li>
    <p>Default and static interface methods</p>
  </li>
  <li>
    <p>Lambda expressionsÂ (also available on API level 23 and lower)</p>
  </li>
  <li>
    <p>Repeatable annotations</p>
  </li>
  <li>
    <p>Method ReferencesÂ (also available on API level 23 and lower)</p>
  </li>
  <li>
    <p>Type AnnotationsÂ (also available on API level 23 and lower)</p>
  </li>
</ul>

<h2 id="default-and-static-interface-methods">Default and static interface methods</h2>

<ul>
  <li>Java interface default methods
    <ul>
      <li>Defender Methods / Virtual extension methods</li>
    </ul>
  </li>
  <li>Java Interface Static Method
    <ul>
      <li>similar to default method except that we canâ€™t override them in the implementation classes</li>
    </ul>
  </li>
</ul>

<h3 id="why-java-8-import-default-interface-methods">why java 8 import default interface methods</h3>

<ul>
  <li>è®¾è®¡æ¥å£éœ€è¦å°å¿ƒç¿¼ç¿¼(Tough)
    <ul>
      <li>éšç€åŠŸèƒ½æ‰©å±•å’Œæ—¶é—´æ¨è¿›ï¼Œå¦‚æœè¦åœ¨æ¥å£æ·»åŠ 
æ–°æ–¹æ³•ï¼Œé‚£ä¹ˆå®ç°è¯¥æ¥å£çš„ç±»ä¹Ÿè¦å“åº”å®ç°è¯¥
å‡½æ•°</li>
    </ul>
  </li>
  <li>å¤§éƒ¨åˆ†æ¡†æ¶éƒ½ä¼šæä¾›ä¸€ä¸ªå®ç°ç±»xxImpl,
    <ul>
      <li>å†extendsè¯¥ç±»é€‰æ‹©è‡ªå·±éœ€è¦çš„æ¥å£</li>
    </ul>
  </li>
</ul>

<p><img src="http://i.imgur.com/lDJTlUc.png" alt="why need default and static method" /></p>

<h3 id="default-method-sample">default method sample</h3>
<p><img src="http://i.imgur.com/KJt94Io.png" alt="default method sample" />
Java8ä¹‹å‰ï¼Œé‚£ä¹ˆæ¯ä¸ªå®ç°äº†è¯¥interfaceçš„ç±»éƒ½è¦å®ç°sortè¿™æ¥å£</p>

<h3 id="default-methodå¥½å¤„å¤šå¤š">Default methodå¥½å¤„å¤šå¤š</h3>
<ul>
  <li>
    <p>æ‰©å±•æ¥å£ä¸ç”¨æ‹…å¿ƒä¼šç ´åå½“å‰çš„å®ç°ç±»</p>
  </li>
  <li>
    <p>Default interface ä½¿abstract classå’Œinterfaceæ›´åŠ æ³¾æ¸­åˆ†æ˜</p>
  </li>
  <li>
    <p>é¿å…å¤§é‡çš„Utility classes</p>
  </li>
  <li>
    <p>é¿å…ç¼–å†™å¤§é‡å®ç°ç±»</p>
  </li>
  <li>
    <p>ä¼˜åŒ–Collections APIï¼Œä»¥ä¾¿æ”¯æŒLambda</p>
  </li>
  <li>
    <p>Default methodä¸èƒ½é‡è½½ObjectåŸºç±»çš„æ–¹æ³•</p>
  </li>
</ul>

<h3 id="java-8æ‰æ”¯æŒå¦åˆ™ä¼šæç¤ºå‡ºé”™">Java 8æ‰æ”¯æŒ(å¦åˆ™ä¼šæç¤ºå‡ºé”™)</h3>
<p><img src="http://i.imgur.com/q8oX9vl.png" alt="support in java8" /></p>

<h3 id="å‘æ•£æ€ç»´">å‘æ•£æ€ç»´</h3>
<ul>
  <li>Java ä¸æ”¯æŒå¤šç»§æ‰¿â€”å°±æ˜¯è¯´ä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿å¦å¤–ä¸€ä¸ªç±»ã€‚æƒ³åŒæ—¶ç»§æ‰¿ä¸¤ä¸ªç±»ï¼ŸForget itï¼
    <ul>
      <li>ä¸ºä»€ä¹ˆï¼Ÿ</li>
    </ul>
  </li>
  <li>Javaæ¥å£(Interface)æ”¯æŒå¤šé‡ç»§æ‰¿
    <ul>
      <li>æ¥å£ä¸­æ‰€æœ‰çš„æ–¹æ³•å¿…é¡»æ˜¯æŠ½è±¡æ–¹æ³•ã€‚(java 7åŠä»¥å‰)</li>
    </ul>
  </li>
  <li>Java8 Interface æ”¯æŒdefault method (java 8)
    <ul>
      <li>éš¾é“æ²¡æœ‰é—®é¢˜ä¹ˆï¼Ÿ</li>
    </ul>
  </li>
</ul>

<h3 id="diamond-problem">Diamond problem</h3>
<p><img src="http://i.imgur.com/nTjxtWD.png" alt="Diamond problem" /></p>

<h3 id="default-methods---diamond-problem">default methods - Diamond Problem</h3>
<p><img src="http://i.imgur.com/1pCXIHe.png" alt="Diamond Problem" />
å¦‚æœBæˆ–è€…Cå…¶ä¸­æœ‰ä¸€ä¸ªå¹¶æ²¡æœ‰å®ç°sayHi() ï¼Œ ç¼–è¯‘å™¨ä¸ä¼šæŠ¥é”™</p>

<h3 id="have-got-to-override-to-avoid-diamond-problem">have got to override to avoid diamond problem</h3>
<p><img src="http://i.imgur.com/uwHyUlr.png" alt="override to avoid diamond problem" />
Avoid Diamond problem , we have to override sayHi()</p>

<h3 id="cannot-override-method-from-object">cannot override method from Object</h3>
<p><img src="http://i.imgur.com/3WWJRPA.png" alt="cannot override method from Object" /></p>

<h3 id="static-method">Static Method</h3>
<ul>
  <li>Static method[å¦‚æœæœ‰çš„è¯]æ˜¯interfaceé¢†åœŸä¸å¯åˆ†å‰²çš„ä¸€éƒ¨åˆ†
    <ul>
      <li>Classä¸èƒ½implementè¿™ä¸ªæ–¹æ³•</li>
      <li>Securityâ€”ä¿è¯æ–¹æ³•çš„å”¯ä¸€æ€§</li>
    </ul>
  </li>
  <li>æ–¹ä¾¿interfaceæä¾›utilityæ–¹æ³•
    <ul>
      <li>Null check</li>
      <li>Collection sorting</li>
    </ul>
  </li>
  <li>å¯ä»¥ç›´æ¥é€šè¿‡æ¥å£çš„æ–¹æ³•è°ƒç”¨æ¥è°ƒç”¨static method</li>
</ul>

<h3 id="abstract-classes-vs-defaultstatic-methods">Abstract Classes Vs Default/Static Methods</h3>
<ul>
  <li>
    <p>æŠ½è±¡ç±»å¯èƒ½åŒ…å«å˜é‡ï¼Œæ¥å£[interface]åªåŒ…å«æ–¹æ³•å’Œå¸¸é‡</p>
  </li>
  <li>
    <p>ç±»åªèƒ½å•ç»§æ‰¿ï¼Œinterfaceå¯ä»¥å¤šç»§æ‰¿</p>
  </li>
  <li>
    <p>ä¸æ˜¯æ‰€æœ‰åœ°æ–¹éƒ½æ¨èç”¨Default/Static Methods</p>
  </li>
</ul>

<h2 id="java-annotations">Java Annotations</h2>

<h3 id="short-description">short description</h3>
<ul>
  <li>What
    <ul>
      <li>a form of metadata, provide data about a program that is not part of the program itself.</li>
      <li>Metadata is data about data. So Annotations are metadata for code.</li>
    </ul>
  </li>
  <li>Why
    <ul>
      <li>Free of boilerplate Java code</li>
      <li>Less likely to contain bugs</li>
    </ul>
  </li>
  <li>When
    <ul>
      <li>Introduced in JDK5</li>
    </ul>
  </li>
</ul>

<h3 id="java-reflection">java reflection</h3>
<ul>
  <li>Performance Overhead
    <ul>
      <li>Generally though the JVM may optimize the normal instantiation but could not make optimizations for the reflective use case.</li>
    </ul>
  </li>
  <li>
    <p>Security Restrictions</p>
  </li>
  <li>Exposure of Internals</li>
</ul>

<p>Performance Overhead
Because reflection involves types that are dynamically resolved, certain Java virtual machine optimizations can not be performed. Consequently, reflective operations have slower performance than their non-reflective counterparts, and should be avoided in sections of code which are called frequently in performance-sensitive applications.
Security Restrictions
Reflection requires a runtime permission which may not be present when running under a security manager. This is in an important consideration for code which has to run in a restricted security context, such as in an Applet.
Exposure of Internals
Since reflection allows code to perform operations that would be illegal in non-reflective code, such as accessingÂ privateÂ fields and methods, the use of reflection can result in unexpected side-effects, which may render code dysfunctional and may destroy portability. Reflective code breaks abstractions and therefore may change behavior with upgrades of the platform.</p>

<h3 id="custom-annotation">custom annotation</h3>
<p><img src="http://i.imgur.com/CUcEG2y.png" alt="annotation policy" />
You applyÂ @DocumentedÂ when defining an annotation, to ensure that classes using your annotation show this in their generated JavaDoc.</p>

<h3 id="repeatable-annotations">Repeatable annotations</h3>
<p><img src="http://i.imgur.com/jvOljJV.png" alt="Repeatable annotations" /></p>

<h2 id="java8-stream">java8 Stream</h2>
<ul>
  <li>
    <p>InputStream and OutputStream from Java I/O? NO!</p>
  </li>
  <li>
    <p>Monadsâ€”javaå‡½æ•°å¼ç¼–ç¨‹
[ËˆmÉ‘:nÃ¦d]</p>
  </li>
  <li>
    <p>Stream() / parallelStream()  create a sequential or a parallel stream</p>
  </li>
  <li>Stream operationsä¸€èˆ¬å’Œlambdaç»“åˆä½¿ç”¨
    <ul>
      <li>intermediate operations</li>
      <li>terminal operation</li>
    </ul>
  </li>
  <li>Stream operations
    <ul>
      <li>non-interfering</li>
      <li>stateless</li>
    </ul>
  </li>
</ul>

<p>A function isÂ non-interferingÂ when it does not modify the underlying data source of the stream</p>

<p>A function isÂ statelessÂ when the execution of the operation is deterministic, e.g. in the above example no lambda expression depends on any mutable variables or states from the outer scope which might change during execution.</p>

<h3 id="java8-stream-1">java8 Stream</h3>

<ul>
  <li>
    <p>å…ƒç´ é›†</p>
  </li>
  <li>
    <p>æ•°æ®æº</p>
  </li>
  <li>
    <p>èšåˆæ“ä½œ(aggregate operations) ï¼š filter, map, limit, reduce, find, matchç­‰ç­‰</p>
  </li>
  <li>
    <p>ç®¡é“(pipelining)</p>
  </li>
</ul>

<p>Stream ä¸æ˜¯é›†åˆå…ƒç´ ï¼Œå®ƒä¸æ˜¯æ•°æ®ç»“æ„å¹¶ä¸ä¿å­˜æ•°æ®ï¼Œå®ƒæ˜¯æœ‰å…³ç®—æ³•å’Œè®¡ç®—çš„ï¼Œå®ƒæ›´åƒä¸€ä¸ªé«˜çº§ç‰ˆæœ¬çš„ Iteratorã€‚
Stream å°±å¦‚åŒä¸€ä¸ªè¿­ä»£å™¨ï¼ˆIteratorï¼‰ï¼Œå•å‘ï¼Œä¸å¯å¾€å¤ï¼Œæ•°æ®åªèƒ½éå†ä¸€æ¬¡ï¼Œéå†è¿‡ä¸€æ¬¡åå³ç”¨å°½äº†ï¼Œå°±å¥½æ¯”æµæ°´ä»é¢å‰æµè¿‡ï¼Œä¸€å»ä¸å¤è¿”ã€‚</p>

<p><img src="http://i.imgur.com/eZ1Kv3z.png" alt="Java8 Stream" /></p>

<h3 id="stream-æœ‰ä¸°å¯Œçš„æ¥å£">Stream æœ‰ä¸°å¯Œçš„æ¥å£</h3>
<p><img src="http://i.imgur.com/jUyfcaZ.png" alt="Stream API" /></p>

<h3 id="java8-predicateæ¥å£">Java8 Predicateæ¥å£</h3>
<ul>
  <li>
    <p>æ–¹ä¾¿å•å…ƒæµ‹è¯•</p>
  </li>
  <li>
    <p>æ–¹ä¾¿ä»£ç ç®¡ç†</p>
  </li>
  <li>
    <p>å¯è¯»æ€§</p>
  </li>
  <li>
    <p>Predicate æ¥å£åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œè¿”å›booleanç±»å‹ã€‚è¯¥æ¥å£åŒ…å«å¤šç§é»˜è®¤æ–¹æ³•æ¥å°†Predicateç»„åˆæˆå…¶ä»–å¤æ‚çš„é€»è¾‘ï¼ˆæ¯”å¦‚ï¼šä¸ï¼Œæˆ–ï¼Œéï¼‰</p>
  </li>
</ul>

<h2 id="lambda">Lambda</h2>

<h3 id="introduction">Introduction</h3>
<ul>
  <li>What is lambda
    <ul>
      <li>Lambda (uppercase Î›, lowercase Î») is the 11th letter of the Greek alphabet</li>
    </ul>
  </li>
  <li>Lambda è¡¨è¾¾å¼â€æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°
<img src="http://i.imgur.com/IcU4yic.png" alt="Lambda icon" />
<img src="http://i.imgur.com/uP0HUSz.png" alt="lambda tips" /></li>
</ul>

<h3 id="lambda-syntax">Lambda Syntax</h3>
<ul>
  <li>åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†
    <ul>
      <li>
        <p>ä¸€ä¸ªæ‹¬å·å†…ç”¨é€—å·åˆ†éš”çš„å½¢å¼å‚æ•°ï¼Œå‚æ•°æ˜¯å‡½æ•°å¼æ¥å£é‡Œé¢æ–¹æ³•çš„å‚æ•°</p>
      </li>
      <li>
        <p>ä¸€ä¸ªç®­å¤´ç¬¦å·ï¼š-&gt;</p>
      </li>
      <li>
        <p>æ–¹æ³•ä½“ï¼Œå¯ä»¥æ˜¯è¡¨è¾¾å¼å’Œä»£ç å—ï¼Œæ–¹æ³•ä½“å‡½æ•°å¼æ¥å£é‡Œé¢æ–¹æ³•çš„å®ç°ï¼Œå¦‚æœæ˜¯ä»£ç å—ï¼Œåˆ™å¿…é¡»ç”¨{}æ¥åŒ…è£¹èµ·æ¥ï¼Œä¸”éœ€è¦ä¸€ä¸ªreturn è¿”å›å€¼ï¼Œä½†æœ‰ä¸ªä¾‹å¤–ï¼Œè‹¥å‡½æ•°å¼æ¥å£é‡Œé¢æ–¹æ³•è¿”å›å€¼æ˜¯voidï¼Œåˆ™æ— éœ€{}</p>
      </li>
    </ul>
  </li>
  <li>(parameters)Â -&gt;Â expressionÂ æˆ–è€…Â (parameters)Â -&gt;Â {Â statements;Â }</li>
</ul>

<h3 id="why-lambda">why Lambda</h3>
<ul>
  <li>
    <p>Lambda expression provides a good alternative to Closure.</p>
  </li>
  <li>
    <p>adds that missing link of functional programming to Java.Â </p>
  </li>
  <li>
    <p>in Java, the lambda expressions are represented as objects</p>
  </li>
</ul>

<h3 id="lambdas-vs-closure">Lambdas VS Closure</h3>
<ul>
  <li>Lambda æ˜¯åŒ¿åå‡½æ•°çš„åˆ«ç§°
    <ul>
      <li>Instance of function</li>
      <li>Non-local variables have been bound</li>
    </ul>
  </li>
  <li>Closureé—­åŒ…ï¼Œæ˜¯æŒ‡å¯ä»¥åŒ…å«è‡ªç”±ï¼ˆæœªç»‘å®šåˆ°ç‰¹å®šå¯¹è±¡ï¼‰å˜é‡çš„ä»£ç å—ï¼›è¿™äº›å˜é‡ä¸æ˜¯åœ¨è¿™ä¸ªä»£ç å—å†…æˆ–è€…ä»»ä½•å…¨å±€ä¸Šä¸‹æ–‡ä¸­å®šä¹‰çš„ï¼Œè€Œæ˜¯åœ¨å®šä¹‰ä»£ç å—çš„ç¯å¢ƒä¸­å®šä¹‰ï¼ˆå±€éƒ¨å˜é‡ï¼‰ã€‚</li>
</ul>

<p>AÂ lambdaÂ is just an anonymous function - a function defined with no name.</p>

<p>AÂ closureÂ is any function whichÂ closes overÂ theÂ environmentÂ in which it was defined.</p>

<p>An anonymous function is a functionÂ literalÂ without a name, while a closure is an instance of a function, aÂ value, whose non-local variables have been bound either to values or toÂ storage locations</p>

<h3 id="lambda-ä½œç”¨åŸŸ">Lambda ä½œç”¨åŸŸ</h3>
<ul>
  <li>
    <p>å¯ä»¥ç›´æ¥åœ¨lambdaè¡¨è¾¾å¼ä¸­è®¿é—®å¤–å±‚çš„å±€éƒ¨å˜é‡</p>
  </li>
  <li>
    <p>å£°æ˜ä¸ºfinalï¼Œæˆ–è€…ä¸åœ¨ä»£ç å—é‡Œé¢ä¿®æ”¹å˜é‡</p>
  </li>
  <li>
    <p>lambdaå†…éƒ¨å¯¹äºå®ä¾‹çš„å­—æ®µä»¥åŠé™æ€å˜é‡æ˜¯å³å¯è¯»åˆå¯å†™(å’ŒåŒ¿åå¯¹è±¡æ˜¯ä¸€è‡´çš„)</p>
  </li>
</ul>

<h3 id="android-studio-ä¼šæé†’ä½ å¯ä»¥ç”¨lambda">Android Studio ä¼šæé†’ä½ å¯ä»¥ç”¨Lambda</h3>
<p><img src="http://i.imgur.com/glkmxfH.png" alt="Android Studio Suggestion" /></p>

<h3 id="lambda-usage">Lambda usage</h3>

<p>#### 
<img src="http://i.imgur.com/1PZTAA4.png" alt="Lambda case 0" /></p>

<hr />

<p>#### 
<img src="http://i.imgur.com/3i3Yw6G.png" alt="Lambda case 1" /></p>

<hr />

<p>#### 
<img src="http://i.imgur.com/iOB4bMN.png" alt="Lambda case 2" /></p>

<hr />

<p>#### 
<img src="http://i.imgur.com/3fJPPuy.png" alt="Lambda case 3" /></p>

<hr />

<h4 id="case-4">case 4</h4>
<p><img src="http://i.imgur.com/jIIyiQM.png" alt="Lambda case 4" />
<img src="http://i.imgur.com/KODvwvO.png" alt="Lambda calculator code" /></p>

:ET